<Project>
  <!-- Determine the target project -->
  <PropertyGroup>
    <TargetProjectName>$([System.Text.RegularExpressions.Regex]::Replace('$(ProjectName)', '^.*Tests\.', ''))</TargetProjectName>
    <TargetProjectPath>..\..\src\$(TargetProjectName)\$(TargetProjectName).csproj</TargetProjectPath>
  </PropertyGroup>
  <!-- Set the root namespace -->
  <PropertyGroup>
    <RootNamespace>$(TargetProjectName)</RootNamespace>
  </PropertyGroup>
  <!-- Code coverage settings -->
  <PropertyGroup>
    <CollectCoverage>true</CollectCoverage>
    <CoverletOutputFormat>cobertura</CoverletOutputFormat>
    <CoverletOutput>TestResults/</CoverletOutput>
    <Include>[$(TargetProjectName)]*</Include>
  </PropertyGroup>
  <!-- Hide TestResults folders -->
  <ItemGroup>
    <Compile Remove="TestResults\**" />
    <EmbeddedResource Remove="TestResults\**" />
    <None Remove="TestResults\**" />
  </ItemGroup>
  <!-- Default project reference -->
  <ItemGroup Condition="Exists('$(TargetProjectPath)')">
    <ProjectReference Include="$(TargetProjectPath)" />
  </ItemGroup>
</Project>
